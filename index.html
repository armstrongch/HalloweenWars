<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Spooky Scramble</title>
		<style type="text/css">
			.monsterCard {
				float: left;
				outline: 1px solid black;
				margin: 5px;
				min-width: 20%;
			}
			.cardHeader {
				text-align: center;
			}
			.cardAttribute {
				cursor: pointer;
				margin: 0px;
			}
			.cardAttributeValue {
				margin: 0px;
			}
			.monsterTable {
				width: 100%;
			}
			.selectMonsterButton {
				width: 100%;
				text-align: center;
			}
			.centerAlignTD {
				text-align: center;
				padding-left: 20px;
				padding-right: 20px;
			}
			.outlineTR {
				outline: 1px solid black;
			}
		</style>
	</head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
	<body onload="setup()">
		<h1 id="info"></h1>
		<div id="draftDiv">
			<div id="monsterCards">	
			</div>
			<div class="monsterCard">
				<h1>Player 1 Team</h1>
				<ol id="team1OL"></ol>
			</div>
			<div class="monsterCard">
				<h1>Player 2 Team</h1>
				<ol id="team2OL"></ol>
			</div>
		</div>
		<div id="controlsDiv" style="display:none">
			<h3>
				<table>
					<th>
						<td class="centerAlignTD">Player 1</td><td class="centerAlignTD">Player 2</td>
					</th>
					<tr class="outlineTR">
						<td>Select Left Lane</td>
						<td class="centerAlignTD">A</td><td class="centerAlignTD">Left</td>
					</tr>
					<tr class="outlineTR">
						<td>Select Middle Lane</td>
						<td class="centerAlignTD">S</td><td class="centerAlignTD">Down</td>
					</tr>
					<tr class="outlineTR">
						<td>Select Right Lane</td>
						<td class="centerAlignTD">D</td><td class="centerAlignTD">Right</td>
					</tr>
				</table>
			</h3>
		</div>
		<script>
			function defineSpooky()
			{
				alert("The spookier a monster is, the stronger it is in a fight.");
			}
			
			function defineScary()
			{
				alert("The scarier a monster is, the less likely other monsters will want to fight it.")
			}
			
			function defineSpeedy()
			{
				alert("The speedier a monster is, the faster it can travel, and the earlier it attacks in a fight.")
			}
			
			function defineGreedy()
			{
				alert("The greedier a monster is, the more souls it harvests in the graveyard.")
			}
			
			function defineCostly()
			{
				alert("The more costly a monster is, the more souls it costs to summon.")
			}
			
			var playerOneTeam = [];
			var playerTwoTeam = [];
			var activePlayerNum = 1;
			
			function selectMonster(name, button)
			{
				button.onclick = null;
				button.disabled = true;
				
				if (activePlayerNum == 1)
				{
					$('#team1OL').append('<li>' + name + '</li>');
					playerOneTeam.push(name);
				}
				else
				{
					$('#team2OL').append('<li>' + name + '</li>');
					playerTwoTeam.push(name);
				}
				
				updateDraftStatus();
			}
			
			function updateDraftStatus()
			{
				var pickNum = playerOneTeam.length + playerTwoTeam.length;
				if ((pickNum == 0) || (pickNum == 3) || (pickNum == 4) || (pickNum == 7) || (pickNum == 8))
				{
					activePlayerNum = 1;
				}
				else
				{
					activePlayerNum = 2;
				}
				$('#info').html('It is Player ' + activePlayerNum + '\'s Turn to Pick!');
				if (pickNum == 10)
				//if (pickNum == 0)
				{
					$('#draftDiv').css('display', 'none');
					$('#controlsDiv').css('display', 'block');
					$('#info').html('Controls:');
				}
			}
			
			function setup()
			{
				for (let i = 0; i < monsterCards.length; i++)
				{
					monsterCard = monsterCards[i];
					monsterCardHTML = monsterCardHTMLTemplate;
					monsterCardHTML = monsterCardHTML.replace("[Name]", monsterCard.name);
					monsterCardHTML = monsterCardHTML.replace("[Spooky]", monsterCard.spooky);
					monsterCardHTML = monsterCardHTML.replace("[Scary]", monsterCard.scary);
					monsterCardHTML = monsterCardHTML.replace("[Speedy]", monsterCard.speedy);
					monsterCardHTML = monsterCardHTML.replace("[Greedy]", monsterCard.greedy);
					monsterCardHTML = monsterCardHTML.replace("[Costly]", monsterCard.costly);
					//We need to do this twice to set the tr values and the text
					monsterCardHTML = monsterCardHTML.replace("[Name]", monsterCard.name);
					monsterCardHTML = monsterCardHTML.replace("[Spooky]", monsterCard.spooky);
					monsterCardHTML = monsterCardHTML.replace("[Scary]", monsterCard.scary);
					monsterCardHTML = monsterCardHTML.replace("[Speedy]", monsterCard.speedy);
					monsterCardHTML = monsterCardHTML.replace("[Greedy]", monsterCard.greedy);
					monsterCardHTML = monsterCardHTML.replace("[Costly]", monsterCard.costly);
					
					$('#monsterCards').html($('#monsterCards').html() + monsterCardHTML);
				}
				
				updateDraftStatus()
			}
			
			function highlightCards(cardAttribute)
			{
				var value = parseInt(cardAttribute.parentElement.parentElement.getAttribute('value'), 10);
				var attributeName = cardAttribute.parentElement.parentElement.children[0].innerText;
				var cardName = cardAttribute.parentElement.parentElement.parentElement.children[0].children[0].children[0].innerText;
				
				var monsterCardDivs = $('#monsterCards div');
				for (let i = 0; i < monsterCardDivs.length; i++)
				{
					var mcd_toTest = monsterCardDivs[i];
					var cardName_toTest = mcd_toTest.children[0].children[0].children[0].children[0].children[0].innerText;
					if (cardName_toTest != cardName)
					{
						var tableRows = mcd_toTest.children[0].children[0];
						for (let j = 1; j < tableRows.children.length; j++)
						{
							var tableRowToTest = tableRows.children[j];
							var attributeName_toTest = tableRowToTest.children[0].children[0].innerText;
							if (attributeName_toTest == attributeName)
							{
								var value_toTest = parseInt(tableRowToTest.attributes['value'].value, 10);
								if (attributeName == "Costly:")
								{
									value_toTest = Math.abs(value_toTest) * -1;
									value = Math.abs(value) * -1;
								}
								if (value_toTest > value)
								{
									tableRowToTest.children[0].children[0].style.backgroundColor  = 'green';
								}
								else if (value_toTest < value)
								{
									tableRowToTest.children[0].children[0].style.backgroundColor  = 'red';
								}
								else
								{
									tableRowToTest.children[0].children[0].style.backgroundColor  = 'yellow';
								}
							}
						}
					}
					
				}
				
			}
			
			function clearHighlightedCards()
			{
				$('p.cardAttribute').css({'background-color':'white'});
			}
			
			function monster(name, spooky, scary, speedy, greedy, costly)
			{
				this.name = name;
				this.spooky = spooky;
				this.scary = scary;
				this.speedy = speedy;
				this.greedy = greedy;
				this.costly = costly;
			}
			
			var monsterCards = [
										//Spooky	Scary	Speedy	Greedy	Costly
										//1-10		#		1-5		1-5		?
				new monster("Goblin", 		1, 		4, 		2, 		4, 		1),
				new monster("Skeleton", 	2, 		8, 		1, 		2, 		2),
				new monster("Frankenstein",	3, 		1, 		1, 		1, 		3),
				new monster("Werewolf", 	4, 		2, 		4, 		1, 		4),
				new monster("Gargoyle", 	5, 		5, 		3, 		5, 		5),
				new monster("Ghost", 		6, 		9,	 	5, 		2, 		6),
				new monster("Dracula",		7, 		3, 		4, 		4, 		7),
				new monster("Swamp Monster",8, 		7, 		1, 		3, 		8),
				new monster("Pumpkin King",	9, 		10,		2, 		4, 		9),
				new monster("Devil", 		10,		6, 		3, 		3, 		10)
			];
			
			var monsterCardHTMLTemplate = "<div class=\"monsterCard\"><table class=\"monsterTable\" ><tr><td colspan=\"2\"><button class=\"selectMonsterButton\" onclick=\"selectMonster(\'[Name]\', this)\"><h1 class=\"cardHeader\">[Name]</h1></button></td></tr><tr value=\"[Spooky]\"><td><p class=\"cardAttribute\" onmouseenter=\"highlightCards(this)\" onmouseleave=\"clearHighlightedCards()\" onclick=\"defineSpooky()\">Spooky:</p></td><td><p class=\"cardAttributeValue\">[Spooky]</p></td></tr><tr value=\"[Scary]\"><td><p class=\"cardAttribute\" onmouseenter=\"highlightCards(this)\" onmouseleave=\"clearHighlightedCards()\" onclick=\"defineScary()\">Scary:</p></td><td><p class=\"cardAttributeValue\">[Scary]</p></td></tr><tr value=\"[Speedy]\"><td><p class=\"cardAttribute\" onmouseenter=\"highlightCards(this)\" onmouseleave=\"clearHighlightedCards()\" onclick=\"defineSpeedy()\">Speedy:</p></td><td><p class=\"cardAttributeValue\">[Speedy]</p></td></tr><tr value=\"[Greedy]\"><td><p class=\"cardAttribute\" onmouseenter=\"highlightCards(this)\" onmouseleave=\"clearHighlightedCards()\" onclick=\"defineGreedy()\">Greedy:</p></td><td><p class=\"cardAttributeValue\">[Greedy]</p></td></tr><tr value=\"[Costly]\"><td><p class=\"cardAttribute\" onmouseenter=\"highlightCards(this)\" onmouseleave=\"clearHighlightedCards()\" onclick=\"defineCostly()\">Costly:</p></td><td><p class=\"cardAttributeValue\">[Costly]</p></td></tr></table></div>";
		</script>
	</body>
</html>
